<!DOCTYPE html>
<html lang="ka">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>იგავ-არაკების სამყარო</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Georgian:wght@100..900&family=Noto+Serif+Georgian:wght@100..900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      body {
        font-family: 'Noto Sans Georgian', sans-serif;
      }
      h1, h2, h3, h4, h5, h6, .serif-font {
        font-family: 'Noto Serif Georgian', serif;
      }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.292.0?deps=react@18.2.0",
    "recharts": "https://esm.sh/recharts@2.10.3?deps=react@18.2.0,react-dom@18.2.0",
    "framer-motion": "https://esm.sh/framer-motion@10.16.4?deps=react@18.2.0,react-dom@18.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/"
  }
}
</script>
  <link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-stone-100 text-stone-900 antialiased">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
      import React, { useState, useEffect, useMemo } from 'react';
      import { createRoot } from 'react-dom/client';
      import { 
        Check, X, ArrowUp, ArrowDown, BookOpen, CheckCircle, 
        ChevronLeft, Award, RefreshCw, BarChart2, Eye 
      } from 'lucide-react';
      import { 
        BarChart, Bar, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell 
      } from 'recharts';
      import { motion, AnimatePresence } from 'framer-motion';

      // --- CONSTANTS & ENUMS (Converted to JS Objects) ---
      const QuestionType = {
        MultipleChoice: 'multiple_choice',
        TrueFalse: 'true_false',
        Matching: 'matching',
        Ordering: 'ordering',
        Grouping: 'grouping',
        Dropdown: 'dropdown'
      };
      
      const CognitiveLevel = {
        Comprehension: 1, // გააზრება
        Analysis: 2,      // ანალიზი
        Evaluation: 3,    // შეფასება
        Relevance: 4      // აქტუალობა
      };

      const AppState = {
        Menu: 0,
        Quiz: 1,
        Results: 2
      };

      // --- DATA ---
      const fables = [
        {
          id: 'f1',
          title: 'მეფე ხორასნისა',
          shortDesc: 'ამბავი გულუხვობისა და ადამიანური ბუნების შესახებ.',
          content: `ხორასანში მეფობდა დიდებული, კეთილგონიერი, უხვი და მოწყალე მეფე. ერთ დღეს მეფემ სამი სალარო (განძთსაცავი) გახსნა, მოუხმო მთელ მის საბრძანებელს და ნება მისცა იმდენი წაეღოთ, რამდენსაც შეძლებდნენ.
თორმეტი საათის განმავლობაში, დიდი თუ პატარა, გლახაკი თუ დიდებული ეზიდებოდა განძს, მაგრამ სალაროები მაინც ვერ დააცარიელეს.
იმ დღეს მეფემ დიდი ნადიმი გადაიხადა და ვეზირები დააფიცა: აბა რომელ თქვენთაგანს გსმენიათ, ჩემი მსგავსი ან ჩემზე მდიდარი და უხვი მეფეო.
ექვსმა ვეზირმა დაიფიცა, რომ მისი მსგავსი არსად გაეგონათ. უმცროს ვეზირს კი გაეცინა.
მეფემ ჰკითხა:
- რა მიზეზით იცინიო?
ვეზირმა დაფიცება მოსთხოვა: თუ სიმართლისთვის არ მომკლავ, გეტყვიო.
მეფემ საკუთარი თავი დაიფიცა.
როცა ვეზირმა გული დაიმშვიდა, მოახსენა: ჩინეთში ერთი ურია არის, მალქოზი ჰქვია და ერთი დიდებული მოყმე ჰყავს, მასზე უხვი და მდიდარი არც ადრე ყოფილა ვინმე და არც დღეის შემდეგ იქნებაო.
ეწყინა მეფეს, მაგრამ დაფიცებული ჰქონდა და ვეზირი ვეღარ მოკლა, თუმცა დააპატიმრა; შემდეგ სამეფო ტანსაცმელი გაიხადა, უბრალოდ შეიმოსა და წავიდა იმ კაცის სანახავად.
მალე მივიდა მის საცხოვრებელთან. იმ კაცს თურმე წესად ჰქონდა: სადაც კი ვინმე უცხოს ნახავდა, თავისთან მიიყვანდა, შემოსავდა, მოასვენებდა, დაასაჩუქრებდა და ისე გაუშვებდა.
ერთ დღეს მოყმე ქალაქის გარშემო დადიოდა, როცა გლახაკის სამოსელში გადაცმული მეფე ნახა. როგორც წესად ჰქონდა, სახლში წაიყვანა და რა პატივსაც სხვებს სცემდა, მასაც იგივე მიაგო. როცა შემოსა, ნახა, რომ საპატიო პირს უფრო ჰგავდა, ვიდრე გლახაკს. მოყმემ სადაურობა და ვინაობა გამოკითხა. როცა მისი მეფობა გაიგო, მუხლებზე დაეცა, თავი უღირსად მიიჩნია და პატიება სთხოვა, რომ ვერ იცნო.
შემდეგ მეფე სტუმრად მიიწვია და ისეთ სახლში შეიყვანა, რომლის მსგავსი თავად მეფესაც არ ენახა. უცხო და საუცხოოდ მორთული: ხალიჩები, ფარდები, ფარდაგები - ყველაფერი ძვირფასი ქსოვილით იყო ნაქსოვი. მეფის საპატივცემულოდ ნადიმი გამართა: ყველა ჭურჭელი ძვირფასი თვლებით იყო მოოჭვილი. მოყმემ ყველაფერი მეფეს აჩუქა.
ცხრა დღე გაატარა მეფემ სტუმრად და ყოველ დღე მასპინძელს წინაზე უკეთეს სახლში მიყავდა. კიდევ უფრო უძვირფასეს ჭურჭელს უძღვნიდა, მხიარულ ნადიმებს უმართავდა და სხვა საჩუქრებითაც ასაჩუქრებდა.
უკვირდა მეფეს ამ კაცის სიმდიდრე და სიუხვე.
მეცხრე დღეს ერთ ისეთ დიდებულ სახლში მიიწვია, სიტყვებით არ გადმოიცემა. ფარდების და ხალიჩების შესაფერი ჭურჭელი, მშვენიერი, გამოთლილი ყვავილები სულ ძვირფასი ქვებით იყო შეფერილი. მოყმემ ეს ყველაფერი მეფეს აჩუქა და სამი ისეთი მგოსანი ქალი მიუძღვნა, თვალი მათზე კეკლუცს ვერაფერს ნახავდა და ყური მათზე მშვენიერ სიმღერას ვერ გაიგონებდა.
წამოვიდა მეფე. ნაჩუქარი განძეულიდან არაფერი წამოიღო, მხოლოდ: ერთი ალმასის თასი, იაგუნდის საწდე (ღვინის ჩამოსასხმელი ჭურჭელი), თვლებით მორთული ყვავილი და სამი მგოსანი ქალი. მასპინძელს მადლობა გადაუხადა: ღვთის წყალობით, მეც გადაგიხდიო.
დაბრუნდა მეფე თავის ქალაქში. უმცროსი ვეზირი პატიმრობიდან გაათავისუფლა, პატივი მიაგო და მასთან ერთად მოილხინა.
მოყმის პატრონი ურია მისანი (გულთმისანი) იყო. ეს ყველაფერი რომ გაიგო, გაჯავრდა მოყმეზე, შეაპყრობინა და ჯალათებს მისი მოკვლა უბრძანა.
როცა მოსაკლავად წაიყვანეს, მოყმე შეევედრა ჯალათებს: ნუ მომკლავთო; სამხრეში ძვირფასი თვალი ჰქონდა დამალული და თავი იმით გამოისყიდა.
ჯალათებმა უთხრეს: თავადაც იცი, რომ ჩვენი პატრონი გულთმისანია, შენ რომ ხმელეთზე დაგტოვოთ, გაიგებს და შენზე ადრე ჩვენ დაგვხოცს; ამიტომ ასე ვიზამთ: კიდობანში ჩაგსვამთ და მკვდრის აკლდამაში დაგფლავთო. ასეც მოიქცნენ.
ურიამ გულთმისნობას მიმართა: ნახა რომ მიწის ზემოთ კაცი აღარ იყო და დაიჯერა მისი სიკვდილი.
ქურდებმა ისარგებლეს ამ ყველაფრით და ჯერ მოყმის სახლი გაქურდეს, შემდეგ კი საფლავის გაქურდვა გადაწყვიტეს. გაიგეს სად იყო აკლდამა, გათხარეს, ამოიღეს კიდობანი და რომ ნახეს შიგნით კაცი იჯდა - გაათავისუფლეს.
წავიდა მოყმე, მოიარა მრავალი ქვეყანა და მეფის ქალაქამდეც მოაღწია. მეფეს დერეფანში ნადიმი ჰქონდა გამართული და მგოსნებს ამღერებდა. როცა მოყმემ ჩაიარა, ერთმა მგოსანმა ქალმა იცნო ძველი პატრონი, ატირდა და ჩანგი ხელიდან გაუვარდა.
მეფემ ჰკითხა: რა შეგემთხვაო?
მგოსანმა ქალმა მოახსენა ვინც დაინახა.
იპოვეს მოყმე; შემოსეს და მოასვენეს. როცა მოისვენა, მეფეს ყველაფერი უამბო, რაც შეემთხვა.
მეორე კვირას შეჯდა მეფე ცხენზე და სალაშქროდ წავიდა, ის ურია მოკლა და მისი სამფლობელო მოყმეს უბოძა, რომელმაც ამდენი სიკეთე გაუკეთა.`
        },
        {
          id: 'f2',
          title: 'ძუნწი დიდვაჭარი',
          shortDesc: 'იგავი სიხარბესა და ბედისწერაზე.',
          content: `ერთმა დიდვაჭარმა იმდენი სიმდიდრე დააგროვა, რომ დათვლილიც არ ჰქონდა. სიბერემდე არც სვა, არც ჭამა და არც შეიმოსა. მერე თქვა: ამდენი ქონება დამიგროვებია, აწი დავჯდები, მოვილხენ, გავიხარებ, და ხარჯვასაც დავიწყებო!
მივიდა ერთ სალაროსთან (განძსაცავთან), რომელიც დაკეტილი იყო და ვერ გააღო; მივიდა მეორე, მესამე სალაროსთან და ვერც ისინი გახსნა.
გაბრაზდა და გინება დაიწყო.
სალაროდან ხმა გამოვიდა: რომელი ხარ, კარს რომ აღებ, აქ რა გესაქმებაო?
დიდვაჭარმა თავისი სახელი უთხრა: ჩემია სალაროა და დახარჯვა მნებავსო.
შიგნიდან ისევ მოესმა: მართალია შენი იყო, მაგრამ დღემდე არც შენ იხმარე და არც ცოლ-შვილს მოახმარე. ახლა ესე ყველაფერი, ხურო (ხის ხელოსანი) ნაზარის არისო.
იწყინა ვაჭარმა და თქვა:
- "ისეთ საქმესა ვიზამ, ეს განძი ჩემთვისაც დაიკარგება და სხვისთვისაცო".
აიღო ვალი, მოატანინა მრავალი ძელი, შიგნიდან გამოახვრეტინა, განძეულით ამოავსო, პირი გადაუჭედა და მდინარეში ჩაყარა.
ხურო ნაზარი თურე ბაღდადელი იყო და იქ ცხოვრობდა სადაც ის მდინარე ჩადიოდა. დილით ის ხურო მდინარის პირას გავიდა: ნუთუ ვინმეს ტივი მოაქვს წყალსო? ნახა, მდინარეს უამრავი ძელი მოჰქონდა უპატრონოდ. მისცა მცურავებს ფული, შეაგზავნა წყალში და გამოაზიდვინა. ყველა ძელი ხუროს სახლის წინ დააწყვეს.
დიდვაჭარი გაჰყვა ძელების კვალს: გავიგო ვინ არის, ვისაც ბედმა გაუღიმაო, დაინახა ხუროს სახლის წინ დაწყობილი ძელები და ხუროს ჰკითხა: - ვინ ხარო?
მან უპასუხა: - მე ნაზარი ხურო ვარო.
დიდვაჭარმა უთხრა: აიღე ერთი ძელი და სახლში შეიტანეო.
როცა შეიტანეს, დიდვაჭარმა ისევ უთხრა: ხელეჩო დაჰკარი ამ ძელს, შიგნით რა დევსო!
დაჰკრა ნაზარმა ძელს ხელეჩო, საიდანაც ძვირფასი თვალ-მარგალიტი გადმოცვივდა.
გაუკვირდა ხუროს და მაშინ დიდვაჭარმა უთხრა: ეხლა რასაც ხედავ, ყველა ეს ძელები განძით არის სავსე, ღმერთმა მე წამართვა და შენ მოგცაო.
ხურომ უთხრა: ღმერთმა შენვე მოგახმაროს, ყველაფერი წაიღეო. დიდვაჭარმა არ გამოართვა - არც ნახევარი და არც მეოთხედი. ხურომ კიდევ ერთი-ორჯერ თხოვა მცირედი ფული მაინც წაეღო, მაგრამ ვაჭარმა ხელი არაფერს ახლო.
მაშინ ხურომ უთხრა: ორი-სამი პური მაინც წაიღეო!
დიდვაჭარი ამაზე დათანხმდა.
ხურო შევიდა სახლში და ცოლს უთხრა:
- სამი დიდი პური გამოაცხვე და შიგნით ძვირფასი და პატიოსანი თვლები ჩადევი. იქნებ იმ კაცმა წაიღოს და ცოლ-შვილი მშიერი არ დაეხოცოსო.
ცოლი ასეც მოიქცა: პურები გამოაცხო, შიგნით თვალ-მარგალიტი ჩაალაგა, ტილოში გაუხვია და ვაჭარს მისცა.
წაიღო დიდვაჭარმა პურები და წავიდა. გზად მიმავალმა, უდაბნოში ერთი თხის ბალნისგან გაკეთებული კარავს მიადგა, რონლშიც ერთი გლახაკი არაბი და მისი ცოლი ნახა. ცოლი ახალი ნამშობიარები იყო. სხვა მეზობლები იქედან წასულიყვნენ და ვერ გაყოლოდა. საწყლებს არც გადასაფარებელი, არც ქვეშსაგებელი, არც ჩვილის შესახვევი არ გააჩნდათ.
ვაჭარმა გლახაკების დახმარება გადაწყვიტა, პურები მისცა და უთხრა: წადით ბაღდადში, ხურო ნაზართან, ეს პურები მიუძღვენით, იგი ღვთის მოშიში კაცია, აკვანს, ქვეშაგებს და სახვეველს მოგცემთო.
უთხრა ეს დიდვაჭარმა და თავის გზაზე წავიდა.
არაბმა პურები ხუროს მიუტანა. მანაც ყველაფერი მისცა, რაც სთხოვეს - აკვანი, ქვეშსაგები, გადასაფარებელი და სახვევები.
ხურო ნაზარი ცოლთან მივიდა და პურები მიართვა.`
        },
        {
          id: 'f3',
          title: 'უგუნური მცურავი',
          shortDesc: 'მოკლე იგავი მოქმედების აუცილებლობაზე.',
          content: `ერთი მცურავი წყალს მოჰქონდა და იძახდა:
- ღმერთო მიშველეო!
მეორე ამხანაგმა უთხრა:
- ხელი გაიქნიე, ნაპირზე გახვალ და ნაშველები იქნებიო.`
        },
        {
          id: 'f4',
          title: 'მეფე და მხატვარი',
          shortDesc: 'სიბრძნე და დიპლომატია.',
          content: `ერთ ცალთვალა მეფეს ხელოვანი მხატვარი ჰყავდა, რომელიც არ მოსწონდა და მიზეზს ეძებდა, რომ სიკვდილით დაესაჯა.
ერთხელ მეფემ უბრძანა მხატვარს:
- მინდა დამხატოო!
მხატვარმა გულში თქვა: ახლა კი მოვიდა ჩემი აღსასრულის დღე, ცალთვალა რომ დავხატო, მომკლავს, როგორ მკადრეო; თუ ორივე თვალს დავუხატავ, მაინც მომკლავს: ჩემი მსგავსი არ არისო.
მხატვარმა ბევრი ფიქრის შემდეგ ეს ხერხი მოიგონა: დახატა ირემი, მეფეს ხელში თოფი მისცა, ბრმა თვალი დაუხუჭა და საღი თვალით ირემი მიზანში ამოაღებინა. 
მხატვარმა ეს სურათი მეფეს მიართვა. მეფემ მიზეზი ვეღარ მოუძებნა და მხატვარი სიკვდილს გადაურჩა.`
        },
        {
          id: 'f5',
          title: 'მოძღვარი მელი',
          shortDesc: 'თვალთმაქცობა და მიმნდობლობა.',
          content: `ძველ ნასოფლარზე ერთი მელა დაცანცარებდა. ერთ ადგილზე, ლილით სავსე სამღებროს ქვევრი პირღია დარჩენილიყო. მელა აქეთ-იქეთ სიარულში ამ ქვევრში ჩავარდა, ამობობღდა და ნახა, რომ შავად შეღებილიყო.
მელა გზას გაუდგა და ერთი მამალი შემოეყარა. მამალმა ჰკითხა მელას:
- რა დაგმართნიაო? 
მელამ უთხრა:
- ჩემს ცხოვრებაში ბევრი ცოდვა ჩავიდინე, ახლა ჭკუას მოვუხმე, ბერად შევდექი და იერუსალიმს მინდა წავიდეო. 
მამალმა უთხრა: რადგან ცოდვებისაგან ხელი აგიღია და კეთილ საქმეს იმრავლებ, მეც წამიყვანე, მადლიაო! 
მელმან წაიყვანა მამალი და გზა გააგრძელეს. 
შემოეყარათ ძერა: ვხედავ მელას უცდუნებიხარ, ვის მისდევო?  - უთხრა ძერამ.
მამალმა უპასუხა: მელა ბერად შემდგარა, იერუსალიმში მიდის და ამიტომ მივსდევო. 
მოეწონა ძერას მამლის პასუხი და ისიც გაჰყვა მელას.
გზაში ოფოფი შემოეყარათ, და როცა იერსუსალიმის ამბავი გაიგო, მელას ისიც გაჰყვა. 
მელა ფრინველებს საკუთარი სოროსაკენ გაუძღვა, თან თავისი მოხერხებული ენით ტკბილად ეუბნებოდა:
- შვილებო, იერუსალიმში მოძღვრის გარეშე არ მიისვლება. აღსარება უნდა ჩამაბაროთ, ცოდვები მოინანიოთ და ისე წავიდეთო. 
ისინიც დამორჩილდნენ. მელამ ისინი სოროში შეიყვანა - სამოძღვრო სახლიაო. თვითონ კარებთან დაჯდა და უთხრა: ორი ცოდვის შენდობა შემიძლია და მესამის კი ვერაო. 
მათ მადლობა მოახსენეს: თუ ორს ცოდვას შეგვინდობ, მესამის შენდობას ვინღა ითხოვსო? 
ფრინველებს თავი უმწიკვლონი ეგონათ, მელა კი მიზეზს ეძებდა. 
მელამ პირველ მოწაფეს, მამალს უბრძანა: ღმერთმა მამლის ყივილი გამთენიისას ბრძანა და შენ ვახშმისთვის უკან რად გადასწევ ხოლმეო? მამალმა შენდობა ითხოვა და აღთქმა დადო, - მეტს აღარ ვიზამო. მელამ შეუნდო. 
მეორე უთხრა: ყველა კაცს თითო ცოლი ჰყავს და შენ ათსაც არ სჯერდები. თუ ვინმე ამახანაგი დაიბრიყვე, ცოლს მასაც ართმევო. მამალმა ისევ დადო აღთქმა - აღარ ჩავიდენო. მელამ ისევ შეუნდო. 
მესამე უთხრა: მხედარი არა ხარ და მშვილდოსანი, დეზები რად გაკრავს, შენ ხომ შენს დღეში ცხენზე არ მჯდარხარო? მამალი მესამეს ცოდვაზედ რაღას იტყოდა? მოსწყვიტა მელამ თავი და წინ დაიდო. 
მელამ ეხლა ძერას უბრძანა: ავი მგალობელი ხარ, არც სტვენა გივარგა და არც ძახილი, მუდამ რად ყივიო? ძერამ აღთქმა დადო, აღარ ვიყივლებო და მელამაც შეუნდო. 
მერე მეორე უთხრა: ღმერთმა საზრდოდ ხვლიკი და თაგვი მოგცა. ერთს ქვრივს სარჩოდ ერთი ქათამი ეგულება, დასვამს საბუდარზე, შენ კი მიხვალ და წიწილებს მოსტაცებო. ძერამ აღუთქვა, - აღარ მოვტაცებო და მელამ ესეც შეუნდო. 
მესამე უთხრა: ექვს თვეს მამლობ და ექვს თვეს დედლობ, გიდი ამიტომ დაგირქვამსო? მოსწყვიტა თავი და დაიდო წინ. 
სანამდე მელა ამ ორისაგან მოიცლიდა, მანამდე ოფოფმა ისეთი ხერხები მოიფიქა, მელას ოსტატობით გადაამეტა. 
ჰკითხა მელმან ოფოფსა:
- ეს თომარ- ჯიღა (სამეფო გვირგვინი) ვინ მოგცაო? 
ოფოფმა უპასუხა:
- სოლომონ ბრძენმა თავისის ხელით დამახურაო. 
მელამ უთხრა:
- მოწმე ვინა გყავსო? 
ოფოფმა უთხრა:
- ერთი მსუქანი ბატი და ერთი მსუქანი იხვიო. 
მელას სიხარბით და მსუნაგობით ჭკუა და გონება დაეფანტა; გულში თქვა: ეს ოფოფი ერთ ლუკმად არ მეყოფა და მსუქან ბატს და იხვს ერთ კვირასაც ვიმყოფინებო. 
ბევრის ნდომა კაცს ასე წაახდენს... მელამ მამალიც და ძერაც იქვე შეუჭმელი დატოვა და ოფოფს გაჰყვა. 
ოფოფმა მელა ერთს ხევში ჩაიტყუა, სადაც მონადირე დახვდა ქორით, მწევრითა და ძაღლებით. 
ოფოფი მონადირეს წინ დაუჯდა. მონადირეს სეფქა (ისარი) უნდა ესროლა, მაგრამ ოფოფი აფრინდა და მელასთან ახლოს დაჯდა. მიჰყვნვნ მონადირენი. ოფოფი ისევ აფრინდა და იმდენი ქმნა, მელამდე მიიყვანა. მეძებრებმა კვალი აიღეს, მელა წინ გაიხტუნეს, დაეწივნენ და ასე გახადეს, ძვალი და რბილი გაუერთიანეს.
ძლივ დაჩეჩქვილმან სული გარდაჰხვეწა.
ოფოფმა დაუძახა:
- მელა, მოწმე ვერ გიშოვნეო!
მელამ უპასუხა:
- როცა მოძღვარი აღსარებას სამოწმედ გაიხდის, უარესიც დაემართებაო! 
ოფოფმა ჯავრი კი ამოიყარა, მაგრამ მამალსა და ძერას არაფერი ეშველა.`
        },
        {
          id: 'f6',
          title: 'ქურდი მკერვალი',
          shortDesc: 'იგავი ჩვევასა და სინდისის შესახებ.',
          content: `იყო ერთი მკერავი, რომელიც ქსოვილებს ჭრიდა და ბევრსაც იპარავდა. ერთ ღამეს სიზმარი ნახა: თითქოს პირში ხე ამოსვლოდა და ყოველი მოპარული ქსოვილის ნაჭერი ტოტებზე ეკიდა.
როცა გაეღვიძა, შეშინდა და შვილს უთხრა: როცა შემამჩნევ რომ ქსოვილის მოპარვა დავაპირო, ხე მომაგონეო! 
ერთხელ ერთმა დიდებულმა, მკერავს უცხო ოქროქსოვილი გამოაჭრევინა. როცა მკერავმა ქსოვლის მოპარვა დაიწყო, შვილმან ხე მოაგონა.
ეწყინა მკერავს და გაბრაზებულმა უთხრა:
- ასეთი ნაქსოვი როდის ეკიდა იმ ხეზეო?`
        },
        {
          id: 'f7',
          title: 'მთიული და კაკლის ხე',
          shortDesc: 'ბუნების წესრიგის სიბრძნე.',
          content: `ერთი კაცი იყო, რომელიც ზეგანზე (მთა) ცხოვრობდა და წალკოტი (ბაღი) არ ენახა. 
ჩამოვიდა ბარში, შევიდა წალკოტში და ყველაფერი ნახა: ხეხილი, მწვანე მდელოები... მოეწონა, ღმერთს მადლობა შესწირა და თქვა: ყველაფერი კარგად მოგიწყვია და ეს ერთი რამ კი ცუდად: - პატარა ბალახისათვის ნესვი მოგიბამს და დიდი ხისათვის ნიგოზიო! 
მიიარ-მოიარა ბაღი და ნიგვზების ძირში დაეძინა. მოვიდა ყვავი, შემოჯდა ნიგოზზე, ჩამოაგდო კაკალი, დაეცა კაცს შუბლზე და გაუტეხა.
ადგა კაცი და თქვა: ღმერთო, შენ უკეთესად მოგიწყვია ყველაფერი, ამ ნიგოზს რომ დიდი ნაყოფი ბმოდა, თავს გამიჭყლეტდაო!`
        },
        {
          id: 'f8',
          title: 'უტკბესი და უმწარესი',
          shortDesc: 'ენის ძალა - სიკეთე და ბოროტება.',
          content: `ერთხელ მეფემ ვეზირს უბრძანა: წადი, ისეთი საჭმელი მომიტანე, რომ  დედამიწაზე მასზე უტკბესი არაფერი იყოსო.
წავიდა ვეზირი, ენა უყიდა, მოუტანა, შეუწვა და აჭამა. მეფეს მოეწონა.
ცოტა ხანში მეფემ ისევ იხმო ვეზირი და უბრძანა: წადი, ისეთი რამ მომიტანე, ქვეყანაზე მასზე უმწარესი არაფერი იშოვებოდესო!
წავიდა ვეზირი, ისევ ენა უყიდა და მოუტანა.
მეფემ ვეზირს მიმართა: მწარე ვისურვე, ენა მომიტანე და ტკბილი ვითხოვე და ენა მომიტანეო?!
ვეზირმა მიუგო: ენაზე მწარე და ენაზე ტკბილი ამქვეყნად არაფერიაო.`
        },
        {
          id: 'f9',
          title: 'სოფლის მაშენებლელნი',
          shortDesc: 'უგუნური ამბიციები და მზაკვრობა.',
          content: `ძაღლი და მამალი დაძმობილდენ: სოფელი ავაშენოთო! 
ძაღლმა უთხრა: როგორ ავაშენოთო? 
მამალმა უთხრა: შენ იყეფე, მე ვიყივლებ და აშენდებაო. 
წავიდნენ ტყეში. ძაღლმა ყეფა დაიწყო და დაეძინა. მამალი ხეზე შეჯდა და ყივილი დაიწყო. მელას ხმა მოესმა, მოვიდა და მამალს ჰკითხა:
- მანდ რას აკეთებო? 
მამალმა უპასუხა:
- სოფელს ვაშენებთო. 
მელამ უთხრა:
- ჩამოდი, სახლის ალაგი (ადგილი) მომიზომეო! 
მამალმა უთხრა:
- მამასახლისი მანდ წევს, გააღვიძე, ეგ მოგიზომავსო! 
მელას მამლის ნდომით აივსო, სიხარბემ სძლია, ძაღლთან მივიდა და მამასახლისობით უხმო: ადექი, სახლის ადგილი მინდაო. 
წამოდგა ძაღლი, მელას გამოუდგა, დაჩეჩქვა და კუდი მოსწყვიტა. წავიდა დაკოდილი, გაგლეჯილი და ნათრევი მელა, გორაზე წამოდგა და დაუძახა: მე ხომ ჩემი ჭკუისა დამემართა, მაგრამ თუ თქვენ მაგ საქმით სოფელი ააშენოთ, თქვენც შეიტყობთო!`
        }
      ];

      const questions = [
        // --- მეფე ხორასნისა ---
        {
          id: 'f1-q1',
          fableId: 'f1',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Comprehension,
          prompt: 'ვინ გაიცინა მეფის შეკითხვაზე, მოიძებნებოდა თუ არა მასზე უფრო მდიდარი ადამიანი?',
          options: ['უფროსმა ვეზირმა', 'უმცროსმა ვეზირმა', 'ჩინელმა მოყმემ', 'მგოსანმა ქალმა'],
          correctAnswer: 'უმცროსმა ვეზირმა',
          explanation: 'უმცროს ვეზირს გაეცინა, რადგან მან იცოდა ჩინელი მოყმის შესახებ, რომელიც მეფეზე ბევრად მდიდარი და უხვი იყო.'
        },
        {
          id: 'f1-q2',
          fableId: 'f1',
          type: QuestionType.Ordering,
          level: CognitiveLevel.Comprehension,
          prompt: 'დაალაგეთ მოვლენები ქრონოლოგიურად:',
          options: [
            'მეფე გადაცმული მიდის მოყმის სანახავად',
            'მეფე ხსნის სამ სალაროს ხალხისთვის',
            'მოყმეს კიდობანში სვამენ და მიწაში ფლავენ',
            'მგოსანი ქალი ცნობს თავის ძველ პატრონს'
          ],
          correctAnswer: [
            'მეფე ხსნის სამ სალაროს ხალხისთვის',
            'მეფე გადაცმული მიდის მოყმის სანახავად',
            'მოყმეს კიდობანში სვამენ და მიწაში ფლავენ',
            'მგოსანი ქალი ცნობს თავის ძველ პატრონს'
          ],
          explanation: 'ჯერ მეფემ გახსნა სალაროები, რამაც გამოიწვია ვეზირის სიცილი, შემდეგ მეფე წავიდა მოყმესთან. მოყმის დაბრუნების შემდეგ ურიამ ის დაასაფლავა, და ბოლოს ქურდების მიერ გადარჩენილი მოყმე მგოსანმა იცნო.'
        },
        {
          id: 'f1-q3',
          fableId: 'f1',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Analysis,
          prompt: 'მოყმემ თავი იმით გადაირჩინა, რომ ჯალათებს დიდი ფული გადაუხადა და გაექცა.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'მცდარია',
          explanation: 'მოყმემ ჯალათებს სამხრეში დამალული ძვირფასი თვალი მისცა, მაგრამ ჯალათებმა ის მაინც ვერ გაუშვეს ურიას შიშის გამო და კიდობანში ჩასვეს.'
        },
        {
          id: 'f1-q4',
          fableId: 'f1',
          type: QuestionType.Grouping,
          level: CognitiveLevel.Analysis,
          prompt: 'გაანაწილეთ პერსონაჟები მათ თვისებებთან:',
          options: [
            { id: '1', text: 'მეფე', category: 'პატივმოყვარე' },
            { id: '2', text: 'მოყმე', category: 'უანგარო' },
            { id: '3', text: 'ურია', category: 'შურიანი' },
            { id: '4', text: 'უმცროსი ვეზირი', category: 'გულწრფელი' }
          ],
          correctAnswer: null,
          explanation: 'მეფეს სურდა ყოფილიყო ყველაზე სახელოვანი, მოყმე გასცემდა სანაცვლოს მოლოდინის გარეშე, ურიამ ვერ აიტანა მოყმის წარმატება, ხოლო ვეზირმა სიმართლე თქვა სიკვდილის შიშის მიუხედავად.'
        },
        {
          id: 'f1-q5',
          fableId: 'f1',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Analysis,
          prompt: 'შეავსეთ წინადადება:',
          options: [
            { text: 'მეფე ხორასნისა იყო ძალიან მდიდარი, მაგრამ მას აწუხებდა' },
            { isBlank: true, correctOption: 'საკუთარი დიდების წყურვილი', options: ['ხალხის სიღარიბე', 'საკუთარი დიდების წყურვილი', 'უცხოელების შემოსევა'] },
            { text: ', რამაც საბოლოოდ აიძულა იგი' },
            { isBlank: true, correctOption: 'ჩინეთში წასულიყო', options: ['ომი დაეწყო', 'ჩინეთში წასულიყო', 'განძი დაემალა'] }
          ],
          correctAnswer: null,
          explanation: 'მეფის მთავარი მოტივაცია იყო დაემტკიცებინა, რომ მასზე უხვი არავინ იყო, რამაც იგი ჩინეთში მოყმის სანახავად წაიყვანა.'
        },
        {
          id: 'f1-q6',
          fableId: 'f1',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Evaluation,
          prompt: 'რას გვასწავლის ურია მალქოზის ბედი?',
          options: ['სიფრთხილეს', 'რომ ბოროტება და შური საბოლოოდ ისჯება', 'რომ ჯადოქრობა სახიფათოა', 'რომ მეფესთან ბრძოლა არ შეიძლება'],
          correctAnswer: 'რომ ბოროტება და შური საბოლოოდ ისჯება',
          explanation: 'ურია, რომელიც ბოროტებითა და შურით მოქმედებდა მოყმის წინააღმდეგ, საბოლოოდ მეფის ხელით დაისაჯა.'
        },
        {
          id: 'f1-q7',
          fableId: 'f1',
          type: QuestionType.Matching,
          level: CognitiveLevel.Comprehension,
          prompt: 'დააკავშირეთ ნივთები მათ მფლობელებთან:',
          options: [
            { id: 'm1', left: 'სამი სალარო', right: 'მეფე' },
            { id: 'm2', left: 'თომარ-ჯიღა (გვირგვინი)', right: 'არავინ (არასწორი არჩევანი)' }, 
            { id: 'm3', left: 'ალმასის თასი', right: 'მოყმე' }
          ],
          correctAnswer: null,
          explanation: 'სამი სალარო მეფემ გახსნა, ხოლო ალმასის თასი მოყმემ აჩუქა მეფეს.'
        },

        // --- ძუნწი დიდვაჭარი ---
        {
          id: 'f2-q1',
          fableId: 'f2',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Comprehension,
          prompt: 'შეავსეთ წინადადება იგავიდან:',
          options: [
            { text: 'დიდვაჭარმა გადაწყვიტა, რომ თავისი ქონება' },
            { isBlank: true, correctOption: 'მდინარეში გადაეყარა', options: ['ღარიბებისთვის დაერიგებინა', 'მდინარეში გადაეყარა', 'ეკლესიისთვის შეეწირა'] },
            { text: ', რათა ის' },
            { isBlank: true, correctOption: 'ხურო ნაზარს არ დარჩენოდა', options: ['არავის დარჩენოდა', 'ხურო ნაზარს არ დარჩენოდა', 'მეფეს არ წაერთმია'] }
          ],
          correctAnswer: null,
          explanation: 'დიდვაჭარი განრისხდა წინასწარმეტყველებაზე, რომ ქონება ხურო ნაზარს ერგებოდა და სცადა ბედისწერის შეცვლა მისი მდინარეში გადაყრით.'
        },
        {
          id: 'f2-q2',
          fableId: 'f2',
          type: QuestionType.Matching,
          level: CognitiveLevel.Relevance,
          prompt: 'დააკავშირეთ სიმბოლოები მათ მნიშვნელობასთან:',
          options: [
            { id: 'm1', left: 'ჩაკეტილი სალარო', right: 'უაზროდ დაგროვილი ქონება' },
            { id: 'm2', left: 'მდინარე', right: 'ბედისწერა / განგება' },
            { id: 'm3', left: 'პური ძვირფასი ქვებით', right: 'ფარული სიკეთე' }
          ],
          correctAnswer: null,
          explanation: 'ჩაკეტილი სალარო მიანიშნებს, რომ გამოუყენებელი სიმდიდრე მკვდარია. მდინარე არის გზა, რომლითაც განგებამ ქონება ადრესატთან მიიტანა.'
        },
        {
          id: 'f2-q3',
          fableId: 'f2',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Analysis,
          prompt: 'ხურო ნაზარმა იცოდა, რომ ძელებში განძი იყო და ამიტომ ამოიტანა ისინი.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'მცდარია',
          explanation: 'ხურო ნაზარს წარმოდგენა არ ჰქონდა განძზე. მან უბრალოდ მდინარის მოტანილი ძელები შეაგროვა საშენ მასალად.'
        },
        {
          id: 'f2-q4',
          fableId: 'f2',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Evaluation,
          prompt: 'რა არის დიდვაჭრის მთავარი შეცდომა?',
          options: ['ცუდი ინვესტიციები', 'სიძუნწე და ბედისწერასთან ბრძოლა', 'მდინარის სიჩქარის არასწორი გათვლა', 'ხუროს ნდობა'],
          correctAnswer: 'სიძუნწე და ბედისწერასთან ბრძოლა',
          explanation: 'მისი მთავარი შეცდომა იყო იმის დაჯერება, რომ სიმდიდრის დაგროვება თვითმიზანია და რომ მას შეუძლია ღვთის ნებას წინ აღუდგეს.'
        },
        {
          id: 'f2-q5',
          fableId: 'f2',
          type: QuestionType.Ordering,
          level: CognitiveLevel.Comprehension,
          prompt: 'როგორ მოხვდა ქონება ნაზართან?',
          options: [
            'ვაჭარმა ძელები მდინარეში ჩაყარა',
            'ნაზარმა ძელები წყლიდან ამოიზიდა',
            'ვაჭარმა პურები გლახაკებს მისცა',
            'გლახაკებმა პურები ნაზარს აჩუქეს'
          ],
          correctAnswer: [
            'ვაჭარმა ძელები მდინარეში ჩაყარა',
            'ნაზარმა ძელები წყლიდან ამოიზიდა',
            'ვაჭარმა პურები გლახაკებს მისცა',
            'გლახაკებმა პურები ნაზარს აჩუქეს'
          ],
          explanation: 'ეს თანმიმდევრობა ასახავს, როგორ დაბრუნდა ქონება (ჯერ ძელებით, შემდეგ პურებით) ნაზართან.'
        },

        // --- უგუნური მცურავი ---
        {
          id: 'f3-q1',
          fableId: 'f3',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Evaluation,
          prompt: 'რა არის იგავის მთავარი სათქმელი?',
          options: ['მხოლოდ ლოცვა საკმარისია გადარჩენისთვის', 'ღმერთი მხოლოდ მას ეხმარება, ვინც თავად იღწვის', 'ცურვის სწავლა აუცილებელია', 'წყალში შესვლა საშიშია'],
          correctAnswer: 'ღმერთი მხოლოდ მას ეხმარება, ვინც თავად იღწვის',
          explanation: 'იგავი გვასწავლის, რომ ღვთის იმედი უნდა გვქონდეს, მაგრამ ჩვენი მხრიდანაც უნდა ვიმოქმედოთ ("ხელი გაიქნიე").'
        },
        {
          id: 'f3-q2',
          fableId: 'f3',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Comprehension,
          prompt: 'მცურავი წყალს მიჰქონდა და ის ცურავდა ნაპირისკენ.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'მცდარია',
          explanation: 'მცურავი კი არ ცურავდა, არამედ მხოლოდ ყვიროდა "ღმერთო მიშველეო", სანამ ამხანაგმა არ დაარიგა.'
        },
        {
          id: 'f3-q3',
          fableId: 'f3',
          type: QuestionType.Grouping,
          level: CognitiveLevel.Analysis,
          prompt: 'დააჯგუფეთ ქმედებები:',
          options: [
            { id: 'a1', text: 'ღმერთო მიშველე', category: 'უმოქმედობა' },
            { id: 'a2', text: 'ხელი გაიქნიე', category: 'მოქმედება' },
            { id: 'a3', text: 'წყალს მიჰქონდა', category: 'უმოქმედობა' },
            { id: 'a4', text: 'ნაპირზე გახვალ', category: 'მოქმედება' }
          ],
          correctAnswer: null,
          explanation: 'ლოცვა მოქმედების გარეშე უგუნურებაა, ხოლო ხელის გაქნევა - გადარჩენის გზა.'
        },

        // --- მეფე და მხატვარი ---
        {
          id: 'f4-q1',
          fableId: 'f4',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Analysis,
          prompt: 'რატომ დახატა მხატვარმა მეფე ირმით და თოფით?',
          options: ['რადგან მეფეს ნადირობა უყვარდა', 'რათა ბრმა თვალი ბუნებრივად დაეხუჭა მიზანში ამოღებისას', 'რათა მეფის სიძლიერე ეჩვენებინა', 'რადგან სხვა სიუჟეტი არ მოაფიქრდა'],
          correctAnswer: 'რათა ბრმა თვალი ბუნებრივად დაეხუჭა მიზანში ამოღებისას',
          explanation: 'ეს იყო დიპლომატიური ხერხი: ნაკლის (ცალი თვალი) დამალვა ისე, რომ ნახატი რეალისტური დარჩენილიყო.'
        },
        {
          id: 'f4-q2',
          fableId: 'f4',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Comprehension,
          prompt: 'მეფეს ძალიან უყვარდა მხატვარი და უნდოდა მისი დაჯილდოება.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'მცდარია',
          explanation: 'პირიქით, მეფეს მხატვარი არ მოსწონდა და მიზეზს ეძებდა მის მოსაკლავად.'
        },
        {
          id: 'f4-q3',
          fableId: 'f4',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Evaluation,
          prompt: 'შეავსეთ დასკვნა:',
          options: [
            { text: 'მხატვარი გადარჩა არა იმიტომ, რომ კარგად ხატავდა, არამედ იმიტომ, რომ გამოიჩინა' },
            { isBlank: true, correctOption: 'სიბრძნე და მოხერხებულობა', options: ['სისწრაფე', 'სიბრძნე და მოხერხებულობა', 'თავხედობა'] },
            { text: '. მან შეძლო სიმართლის თქმა' },
            { isBlank: true, correctOption: 'შეურაცხყოფის გარეშე', options: ['შეურაცხყოფის გარეშე', 'ტყუილით', 'შიშით'] }
          ],
          correctAnswer: null,
          explanation: 'მხატვარმა გამოიჩინა დიპლომატია - დახატა სიმართლე (ცალი თვალი დახუჭული), მაგრამ კონტექსტი ისე შეცვალა, რომ ეს ნაკლი აღარ იყო.'
        },
        {
          id: 'f4-q4',
          fableId: 'f4',
          type: QuestionType.Ordering,
          level: CognitiveLevel.Analysis,
          prompt: 'დაალაგეთ მხატვრის ფიქრების თანმიმდევრობა:',
          options: [
            'მეფემ ბრძანა დახატვა',
            'თუ ცალთვალას დავხატავ - მომკლავს',
            'თუ ორთვალას დავხატავ - მომკლავს (არ ვგავარ)',
            'დავხატავ ნადირობის სცენას'
          ],
          correctAnswer: [
            'მეფემ ბრძანა დახატვა',
            'თუ ცალთვალას დავხატავ - მომკლავს',
            'თუ ორთვალას დავხატავ - მომკლავს (არ ვგავარ)',
            'დავხატავ ნადირობის სცენას'
          ],
          explanation: 'მხატვარმა განიხილა ორივე ცუდი ვარიანტი და შემდეგ მიაგნო მესამე, მომგებიან გზას.'
        },

        // --- მოძღვარი მელი ---
        {
          id: 'f5-q1',
          fableId: 'f5',
          type: QuestionType.Ordering,
          level: CognitiveLevel.Comprehension,
          prompt: 'რომელი თანმიმდევრობით შეუერთდნენ ცხოველები მელას?',
          options: ['მამალი', 'ძერა', 'ოფოფი'],
          correctAnswer: ['მამალი', 'ძერა', 'ოფოფი'],
          explanation: 'ჯერ მამალი შეხვდა, შემდეგ ძერა შეუერთდათ, და ბოლოს ოფოფი.'
        },
        {
          id: 'f5-q2',
          fableId: 'f5',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Relevance,
          prompt: 'თანამედროვე სამყაროში, რისი სიმბოლოა "მოძღვარი მელი"?',
          options: ['კარგი მასწავლებლის', 'მატყუარა პოლიტიკოსის ან ლიდერის', 'გულუბრყვილო ადამიანის', 'ბუნების დამცველის'],
          correctAnswer: 'მატყუარა პოლიტიკოსის ან ლიდერის',
          explanation: 'მელა განასახიერებს ქარიზმატულ, მაგრამ მატყუარა ლიდერს, რომელიც ხალხის (ფრინველების) ნდობას ბოროტად იყენებს.'
        },
        {
          id: 'f5-q3',
          fableId: 'f5',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Comprehension,
          prompt: 'შეავსეთ ტექსტი:',
          options: [
            { text: 'მელა ჩავარდა' },
            { isBlank: true, correctOption: 'სამღებრო ქვევრში', options: ['მდინარეში', 'სამღებრო ქვევრში', 'ორმოში'] },
            { text: 'და თავი მოაჩვენა, როგორც' },
            { isBlank: true, correctOption: 'ბერი / მოძღვარი', options: ['მეფე', 'ბერი / მოძღვარი', 'მსაჯული'] }
          ],
          correctAnswer: null,
          explanation: 'მელამ შემთხვევითი ფერის ცვლილება გამოიყენა, რომ თავი წმინდანად გაესაღებინა.'
        },
        {
          id: 'f5-q4',
          fableId: 'f5',
          type: QuestionType.Grouping,
          level: CognitiveLevel.Analysis,
          prompt: 'რომელ ფრინველს რა "ცოდვა" მოუგონა მელამ?',
          options: [
            { id: 'b1', text: 'მამალი', category: 'მრავალცოლიანობა' },
            { id: 'b2', text: 'ძერა', category: 'სხვისი ქათმის მოპარვა' },
            { id: 'b3', text: 'მამალი', category: 'უდროოდ ყივილი' },
            { id: 'b4', text: 'ძერა', category: 'ავი მგალობელი' }
          ],
          correctAnswer: null,
          explanation: 'მელამ ყველა ფრინველს მოუძებნა ბუნებრივი თვისება და ცოდვად ჩაუთვალა, რათა მათი შეჭმის მიზეზი ჰქონოდა.'
        },
        {
          id: 'f5-q5',
          fableId: 'f5',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Evaluation,
          prompt: 'როგორ მოახერხა ოფოფმა მელას დამარცხება?',
          options: ['ფიზიკური ძალით', 'სხვისი დახმარებით და მოხერხებულობით', 'გაქცევით', 'მელას შეეცოდა ოფოფი'],
          correctAnswer: 'სხვისი დახმარებით და მოხერხებულობით',
          explanation: 'ოფოფმა გამოიყენა მელას სიხარბე (ბატისა და იხვის დაპირება) და მიიყვანა იგი მონადირესთან.'
        },
        {
          id: 'f5-q6',
          fableId: 'f5',
          type: QuestionType.Matching,
          level: CognitiveLevel.Analysis,
          prompt: 'დააკავშირეთ პერსონაჟი მის როლთან:',
          options: [
            { id: 'c1', left: 'მელა', right: 'ფარისეველი' },
            { id: 'c2', left: 'მამალი და ძერა', right: 'მიმნდობი მსხვერპლი' },
            { id: 'c3', left: 'ოფოფი', right: 'ჭკვიანი და მოხერხებული' }
          ],
          correctAnswer: null,
          explanation: 'მელა ფარისევლობს, მამალი და ძერა ბრმად ენდობიან, ოფოფი კი ჭკუით ჯობნის მტერს.'
        },
        {
          id: 'f5-q7',
          fableId: 'f5',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Comprehension,
          prompt: 'მელამ ოფოფს უთხრა, რომ მესამე ცოდვის მიტევებაც შეეძლო.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'მცდარია',
          explanation: 'მელამ თავიდანვე უთხრა: "ორი ცოდვის შენდობა შემიძლია და მესამის კი ვერაო", რითაც დაიტოვა მიზეზი მათი შეჭმისთვის.'
        },

        // --- ქურდი მკერვალი ---
        {
          id: 'f6-q1',
          fableId: 'f6',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Comprehension,
          prompt: 'რა ესიზმრა მკერავს?',
          options: ['რომ მეფემ დააჯილდოვა', 'რომ პირში ხე ამოუვიდა მოპარული ქსოვილებით', 'რომ მისი სახლი დაიწვა', 'რომ შვილი გარდაეცვალა'],
          correctAnswer: 'რომ პირში ხე ამოუვიდა მოპარული ქსოვილებით',
          explanation: 'სიზმარი იყო გაფრთხილება მისი ცოდვების შესახებ - მოპარული ქსოვილები ხის ტოტებზე ეკიდა.'
        },
        {
          id: 'f6-q2',
          fableId: 'f6',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Analysis,
          prompt: 'მკერავმა შვილს სთხოვა, რომ ქურდობის დროს შეეჩერებინა.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'ჭეშმარიტია',
          explanation: 'სიზმრით შეშინებულმა მკერავმა შვილს უთხრა: "როცა შემამჩნევ რომ ქსოვილის მოპარვა დავაპირო, ხე მომაგონეო".'
        },
        {
          id: 'f6-q3',
          fableId: 'f6',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Analysis,
          prompt: 'რატომ გაუბრაზდა მკერავი შვილს?',
          options: [
            { text: 'როცა შვილმა ხე მოაგონა, მკერავს სძლია' },
            { isBlank: true, correctOption: 'სიხარბემ', options: ['სინდისმა', 'სიხარბემ', 'შიშმა'] },
            { text: 'და თქვა, რომ ასეთი ძვირფასი ქსოვილი' },
            { isBlank: true, correctOption: 'ხეზე არ ეკიდა', options: ['უკვე ჰქონდა', 'ხეზე არ ეკიდა', 'მეფეს არ ეკუთვნოდა'] }
          ],
          correctAnswer: null,
          explanation: 'ოქროქსოვილის დანახვამ მკერავს დაავიწყა შიში და სინდისი. მან თავი იმართლა იმით, რომ ასეთი ძვირფასი ნაჭერი სიზმარში არ უნახავს.'
        },
        {
          id: 'f6-q4',
          fableId: 'f6',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Relevance,
          prompt: 'რა არის იგავის მთავარი მორალი?',
          options: ['სიზმრებს არ უნდა დავუჯეროთ', 'ჩვევა რჯულზე უმტკიცესიაო', 'შვილებმა მშობლებს ჭკუა არ უნდა ასწავლონ', 'მკერავები ყოველთვის იპარავენ'],
          correctAnswer: 'ჩვევა რჯულზე უმტკიცესიაო',
          explanation: 'იგავი გვიჩვენებს, რომ ძველი ჩვევა (ქურდობა) და სიხარბე ხშირად უფრო ძლიერია, ვიდრე შიში ან სინანული.'
        },
        {
          id: 'f6-q5',
          fableId: 'f6',
          type: QuestionType.Grouping,
          level: CognitiveLevel.Analysis,
          prompt: 'დააჯგუფეთ მკერავის რეაქციები:',
          options: [
            { id: 'd1', text: 'სიზმრის ნახვა', category: 'სინანული / შიში' },
            { id: 'd2', text: 'შვილისთვის თხოვნა', category: 'სინანული / შიში' },
            { id: 'd3', text: 'ოქროქსოვილის დანახვა', category: 'ცდუნება / სიხარბე' },
            { id: 'd4', text: 'შვილის გაკიცხვა', category: 'ცდუნება / სიხარბე' }
          ],
          correctAnswer: null,
          explanation: 'თავდაპირველად მკერავი შეშინებულია, მაგრამ ძვირფასი ნაჭრის დანახვისას სიხარბე იმარჯვებს.'
        },
        {
          id: 'f6-q6',
          fableId: 'f6',
          type: QuestionType.Matching,
          level: CognitiveLevel.Comprehension,
          prompt: 'დააკავშირეთ სიმბოლოები:',
          options: [
            { id: 'e1', left: 'ხე პირში', right: 'დანაშაულის მხილება' },
            { id: 'e2', left: 'ოქროქსოვილი', right: 'დაუძლეველი ცდუნება' },
            { id: 'e3', left: 'შვილი', right: 'სინდისის ხმა' }
          ],
          correctAnswer: null,
          explanation: 'ხე სიზმარში მის დანაშაულს ამხელს, შვილი ცდილობს შეახსენოს პირობა, ხოლო ოქროქსოვილი არის ის, რამაც აცდუნა.'
        },

        // --- მთიული და კაკლის ხე ---
        {
          id: 'f7-q1',
          fableId: 'f7',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Comprehension,
          prompt: 'რა გაუკვირდა მთიულს ბაღში?',
          options: ['რომ ხილი ძალიან გემრიელი იყო', 'რომ დიდ ხეს (კაკალს) პატარა ნაყოფი ჰქონდა, ხოლო პატარა ბალახს (ნესვს) - დიდი', 'რომ ბაღში არავინ მუშაობდა', 'რომ ხეები გამხმარი იყო'],
          correctAnswer: 'რომ დიდ ხეს (კაკალს) პატარა ნაყოფი ჰქონდა, ხოლო პატარა ბალახს (ნესვს) - დიდი',
          explanation: 'მან ღმერთს დაუწუნა ეს წყობა: "პატარა ბალახისათვის ნესვი მოგიბამს და დიდი ხისათვის ნიგოზიო".'
        },
        {
          id: 'f7-q2',
          fableId: 'f7',
          type: QuestionType.Ordering,
          level: CognitiveLevel.Comprehension,
          prompt: 'აღადგინეთ მოვლენების თანმიმდევრობა:',
          options: [
            'კაცი ჩამოვიდა ბარში და ბაღი ნახა',
            'დაიწუნა ნესვისა და კაკლის განაწილება',
            'კაკლის ძირში დაიძინა',
            'ყვავმა კაკალი ჩამოაგდო და კაცს დაეცა'
          ],
          correctAnswer: [
            'კაცი ჩამოვიდა ბარში და ბაღი ნახა',
            'დაიწუნა ნესვისა და კაკლის განაწილება',
            'კაკლის ძირში დაიძინა',
            'ყვავმა კაკალი ჩამოაგდო და კაცს დაეცა'
          ],
          explanation: 'კაცი ჯერ აკვირდება ბაღს, გამოთქვამს უკმაყოფილებას, იძინებს და შემდეგ იღებს გაკვეთილს.'
        },
        {
          id: 'f7-q3',
          fableId: 'f7',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Evaluation,
          prompt: 'კაცი მიხვდა, რომ ბუნებაში ყველაფერი გონივრულად არის მოწყობილი.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'ჭეშმარიტია',
          explanation: 'როცა კაკალი დაეცა, ის მიხვდა: "ამ ნიგოზს რომ დიდი ნაყოფი ბმოდა, თავს გამიჭყლეტდაო".'
        },
        {
          id: 'f7-q4',
          fableId: 'f7',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Analysis,
          prompt: 'შეავსეთ დასკვნა:',
          options: [
            { text: 'კაცმა თავიდან იფიქრა, რომ ღმერთმა' },
            { isBlank: true, correctOption: 'შეცდომა დაუშვა', options: ['ყველაფერი კარგად ქნა', 'შეცდომა დაუშვა', 'დაავიწყდა ნესვი'] },
            { text: ', მაგრამ საბოლოოდ მიხვდა, რომ დიდი ნაყოფი მაღალ ხეზე' },
            { isBlank: true, correctOption: 'სახიფათო იქნებოდა', options: ['უფრო ლამაზი იქნებოდა', 'ვერ გაიზრდებოდა', 'სახიფათო იქნებოდა'] }
          ],
          correctAnswer: null,
          explanation: 'იგავი გვიჩვენებს, რომ ერთი შეხედვით უცნაურ ბუნებრივ წესრიგს ღრმა აზრი და უსაფრთხოების მიზანი აქვს.'
        },
        {
          id: 'f7-q5',
          fableId: 'f7',
          type: QuestionType.Grouping,
          level: CognitiveLevel.Analysis,
          prompt: 'შეადარეთ კაცის აზრები:',
          options: [
            { id: 'g1', text: 'დიდ ხეს დიდი ნაყოფი უნდა ჰქონდეს', category: 'თავდაპირველი (მცდარი) აზრი' },
            { id: 'g2', text: 'პატარა ბალახს პატარა ნაყოფი უნდა ჰქონდეს', category: 'თავდაპირველი (მცდარი) აზრი' },
            { id: 'g3', text: 'ღმერთს უკეთესად მოუწყვია ყველაფერი', category: 'საბოლოო (ჭეშმარიტი) აზრი' },
            { id: 'g4', text: 'დიდი ნაყოფი ხეზე სახიფათოა', category: 'საბოლოო (ჭეშმარიტი) აზრი' }
          ],
          correctAnswer: null,
          explanation: 'თავიდან კაცს ეგონა, რომ პროპორცია დარღვეული იყო, მაგრამ გამოცდილებამ საპირისპირო დაუმტკიცა.'
        },
        {
          id: 'f7-q6',
          fableId: 'f7',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Evaluation,
          prompt: 'რა როლი შეასრულა ყვავმა ამ ამბავში?',
          options: ['მან კაცი გააღვიძა საფრთხის წინ', 'ის იყო "მასწავლებელი", რომელმაც უნებლიედ ჭეშმარიტება დაანახა კაცს', 'მას უბრალოდ კაკლის ჭამა უნდოდა', 'ის კაცს თავს დაესხა'],
          correctAnswer: 'ის იყო "მასწავლებელი", რომელმაც უნებლიედ ჭეშმარიტება დაანახა კაცს',
          explanation: 'ყვავის ქმედებამ (კაკლის ჩამოგდებამ) გამოიწვია ის ფიზიკური შედეგი, რამაც კაცს აზრი შეაცვლევინა.'
        },

        // --- უტკბესი და უმწარესი ---
        {
          id: 'f8-q1',
          fableId: 'f8',
          type: QuestionType.Matching,
          level: CognitiveLevel.Comprehension,
          prompt: 'რა მოითხოვა მეფემ და რა მოუტანა ვეზირმა?',
          options: [
            { id: 'h1', left: 'ყველაზე ტკბილი', right: 'ენა' },
            { id: 'h2', left: 'ყველაზე მწარე', right: 'ისევ ენა' },
            { id: 'h3', left: 'ოქრო', right: 'არ მოუთხოვია' }
          ],
          correctAnswer: null,
          explanation: 'ვეზირმა ორივეჯერ ენა მიიტანა, რადგან ენაზე ტკბილი და მწარე არაფერია.'
        },
        {
          id: 'f8-q2',
          fableId: 'f8',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Evaluation,
          prompt: 'რას გულისხმობდა ვეზირი?',
          options: ['რომ ენა ყველაზე გემრიელი ხორცია', 'რომ სიტყვას (ენას) შეუძლია უდიდესი სიკეთეც მოიტანოს და უდიდესი ბოროტებაც', 'რომ მეფეს გემოვნება არ აქვს', 'რომ ბაზარში მხოლოდ ენა იყიდებოდა'],
          correctAnswer: 'რომ სიტყვას (ენას) შეუძლია უდიდესი სიკეთეც მოიტანოს და უდიდესი ბოროტებაც',
          explanation: 'იგავი ალეგორიულია: ენა (მეტყველება) არის ინსტრუმენტი, რომელსაც შეუძლია გაახაროს ადამიანი (ტკბილი) ან გაანადგუროს (მწარე).'
        },
        {
          id: 'f8-q3',
          fableId: 'f8',
          type: QuestionType.TrueFalse,
          level: CognitiveLevel.Comprehension,
          prompt: 'მეფე გაბრაზდა, როცა მეორედაც ენა მიუტანეს.',
          options: ['ჭეშმარიტია', 'მცდარია'],
          correctAnswer: 'მცდარია',
          explanation: 'ტექსტში არ ჩანს, რომ მეფე გაბრაზდა; მან უბრალოდ გაოცებულმა იკითხა მიზეზი, და ვეზირის პასუხი სავარაუდოდ დამაკმაყოფილებელი იყო.'
        },
        {
          id: 'f8-q4',
          fableId: 'f8',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Relevance,
          prompt: 'წაიკითხეთ სოლომონ ბრძენის სამი შეგონება:',
          options: [
            { text: 'სულხან-საბას არაკს შეესაბამება:' },
            { isBlank: true, correctOption: 'სიკვდილ-სიცოცხლე ენის ხელშია.', options: ['ბრიყვს დავაში ითრევს მისი ბაგეები.', 'სიკვდილ-სიცოცხლე ენის ხელშია.', 'კაცის ბაგის სიტყვები ღრმა წყალია.'] },
            { text: '.' },
          ],
          correctAnswer: null,
          explanation: 'ეს ანდაზა კარგად გამოხატავს ენის ძალასა და პასუხისმგებლობას.'
        },
        {
          id: 'f8-q5',
          fableId: 'f8',
          type: QuestionType.Grouping,
          level: CognitiveLevel.Analysis,
          prompt: 'დააჯგუფეთ ენის "ნაყოფები":',
          options: [
            { id: 'i1', text: 'ნუგეში', category: 'ტკბილი' },
            { id: 'i2', text: 'შექება', category: 'ტკბილი' },
            { id: 'i3', text: 'ჭორაობა', category: 'მწარე' },
            { id: 'i4', text: 'შეურაცხყოფა', category: 'მწარე' }
          ],
          correctAnswer: null,
          explanation: 'სიტყვები შეიძლება იყოს სამკურნალო (ტკბილი) ან გულსატკენი (მწარე).'
        },
        {
          id: 'f8-q6',
          fableId: 'f8',
          type: QuestionType.Ordering,
          level: CognitiveLevel.Comprehension,
          prompt: 'მოვლენების თანმიმდევრობა:',
          options: [
            'მეფემ უტკბესი საჭმელი ითხოვა',
            'ვეზირმა ენა მიართვა (პირველად)',
            'მეფემ უმწარესი საჭმელი ითხოვა',
            'ვეზირმა ენა მიართვა და ახსნა თავისი არჩევანი'
          ],
          correctAnswer: [
            'მეფემ უტკბესი საჭმელი ითხოვა',
            'ვეზირმა ენა მიართვა (პირველად)',
            'მეფემ უმწარესი საჭმელი ითხოვა',
            'ვეზირმა ენა მიართვა და ახსნა თავისი არჩევანი'
          ],
          explanation: 'ეს არის იგავის სიუჟეტური ხაზი.'
        },

        // --- სოფლის მაშენებლელნი ---
        {
          id: 'f9-q1',
          fableId: 'f9',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Comprehension,
          prompt: 'ვინ დაძმობილდა სოფლის ასაშენებლად?',
          options: ['მელა და მამალი', 'ძაღლი და მამალი', 'კატა და ძაღლი', 'მგელი და მელა'],
          correctAnswer: 'ძაღლი და მამალი',
          explanation: 'იგავი იწყება ძაღლისა და მამლის დაძმობილებით.'
        },
        {
          id: 'f9-q2',
          fableId: 'f9',
          type: QuestionType.Dropdown,
          level: CognitiveLevel.Comprehension,
          prompt: 'შეავსეთ დიალოგი:',
          options: [
            { text: 'მელამ ჰკითხა: მანდ რას აკეთებო? მამალმა უპასუხა:' },
            { isBlank: true, correctOption: 'სოფელს ვაშენებთო', options: ['ხეს ვრგავთო', 'სოფელს ვაშენებთო', 'გვძინავსო'] },
            { text: '. მელამ სთხოვა:' },
            { isBlank: true, correctOption: 'სახლის ალაგი მომიზომეო', options: ['საჭმელი მომეციო', 'სახლის ალაგი მომიზომეო', 'წყალი დამალევინეო'] }
          ],
          correctAnswer: null,
          explanation: 'მამალმა გულუბრყვილოდ (ან ირონიულად) უპასუხა, რომ სოფელს აშენებდნენ, მელამ კი ეს შანსად გამოიყენა.'
        },
        {
          id: 'f9-q3',
          fableId: 'f9',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Analysis,
          prompt: 'რა იყო მელას ნამდვილი მიზანი?',
          options: ['სოფლის აშენებაში დახმარება', 'მამლის შეჭმა', 'ძაღლთან დამეგობრება', 'უძრავი ქონების შეძენა'],
          correctAnswer: 'მამლის შეჭმა',
          explanation: 'ტექსტში წერია: "მელას მამლის ნდომით აივსო, სიხარბემ სძლია". მას მამლის მონადირება სურდა.'
        },
        {
          id: 'f9-q4',
          fableId: 'f9',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Analysis,
          prompt: 'როგორ მოატყუა მამალმა მელა?',
          options: ['გაფრინდა და დაიმალა', 'უთხრა, რომ მამასახლისი (ძაღლი) გაეღვიძებინა', 'ყვირილით შეაშინა', 'უთხრა, რომ ავად იყო'],
          correctAnswer: 'უთხრა, რომ მამასახლისი (ძაღლი) გაეღვიძებინა',
          explanation: 'მამალმა იცოდა, რომ ძაღლი მელას გაუმკლავდებოდა, ამიტომ მელა "მამასახლისთან" გაგზავნა.'
        },
        {
          id: 'f9-q5',
          fableId: 'f9',
          type: QuestionType.Matching,
          level: CognitiveLevel.Comprehension,
          prompt: 'დააკავშირეთ პერსონაჟები და მათი "პროფესიები" იგავში:',
          options: [
            { id: 'j1', left: 'მამალი', right: 'მყვირალი მშენებელი' },
            { id: 'j2', left: 'ძაღლი', right: 'მამასახლისი' },
            { id: 'j3', left: 'მელა', right: 'მსურველი (დაზარალებული)' }
          ],
          correctAnswer: null,
          explanation: 'მამალმა ძაღლი "მამასახლისად" მოიხსენია, თავად კი ყივილით "აშენებდა".'
        },
        {
          id: 'f9-q6',
          fableId: 'f9',
          type: QuestionType.MultipleChoice,
          level: CognitiveLevel.Evaluation,
          prompt: 'რას ნიშნავს მელას ბოლო სიტყვები: "თუ თქვენ მაგ საქმით სოფელი ააშენოთ, თქვენც შეიტყობთო"?',
          options: ['რომ ისინი მალე დაასრულებდნენ მშენებლობას', 'დასცინის მათ საქმიანობას - ყეფით და ყივილით სოფელი არ აშენდება', 'რომ მელა დაბრუნდება და დაეხმარება', 'რომ სოფელი ძალიან ლამაზი გამოვა'],
          correctAnswer: 'დასცინის მათ საქმიანობას - ყეფით და ყივილით სოფელი არ აშენდება',
          explanation: 'მიუხედავად იმისა, რომ დაზარალდა, მელა მაინც ამჩნევს მათი "საქმის" უაზრობას: მხოლოდ ხმაურით საქმე არ კეთდება.'
        },
        {
          id: 'f9-q7',
          fableId: 'f9',
          type: QuestionType.Ordering,
          level: CognitiveLevel.Comprehension,
          prompt: 'დაალაგეთ მოვლენები:',
          options: [
            'ძაღლი და მამალი წავიდნენ ტყეში',
            'მამალმა მელა ძაღლთან გაგზავნა',
            'მელამ მამალს სახლის ადგილი სთხოვა',
            'ძაღლმა მელას კუდი მოსწყვიტა'
          ],
          correctAnswer: [
            'ძაღლი და მამალი წავიდნენ ტყეში',
            'მელამ მამალს სახლის ადგილი სთხოვა',
            'მამალმა მელა ძაღლთან გაგზავნა',
            'ძაღლმა მელას კუდი მოსწყვიტა'
          ],
          explanation: 'სიუჟეტის განვითარება: დაწყება -> მელას გამოჩენა -> მამლის ხრიკი -> ძაღლის თავდასხმა.'
        }
      ];

      // --- COMPONENTS ---
      
      // 1. Multiple Choice & True/False
      const MultipleChoice = ({ question, onAnswer, isAnswered }) => {
        const [selected, setSelected] = useState(null);

        const handleSelect = (option) => {
          if (isAnswered) return;
          setSelected(option);
          onAnswer(option === question.correctAnswer);
        };

        return (
          <div className="grid grid-cols-1 gap-3 mt-4">
            {question.options.map((option, idx) => {
              const isSelected = selected === option;
              const isCorrect = option === question.correctAnswer;
              let btnClass = "p-4 rounded-xl border-2 text-left transition-all duration-200 text-lg font-medium ";
              
              if (isAnswered) {
                if (isCorrect) btnClass += "bg-emerald-100 border-emerald-500 text-emerald-800";
                else if (isSelected && !isCorrect) btnClass += "bg-red-100 border-red-500 text-red-800";
                else btnClass += "bg-white border-stone-200 opacity-50";
              } else {
                btnClass += isSelected 
                  ? "bg-amber-100 border-amber-500 text-amber-900" 
                  : "bg-white border-stone-200 hover:border-amber-300 hover:bg-amber-50";
              }

              return (
                <button
                  key={idx}
                  onClick={() => handleSelect(option)}
                  disabled={isAnswered}
                  className={btnClass}
                >
                  <div className="flex justify-between items-center">
                    <span>{option}</span>
                    {isAnswered && isCorrect && <Check className="text-emerald-600" size={24} />}
                    {isAnswered && isSelected && !isCorrect && <X className="text-red-600" size={24} />}
                  </div>
                </button>
              );
            })}
          </div>
        );
      };

      // 2. Ordering
      const Ordering = ({ question, onAnswer, isAnswered }) => {
        const [items, setItems] = useState([...question.options].sort(() => Math.random() - 0.5));

        const moveItem = (index, direction) => {
          if (isAnswered) return;
          const newItems = [...items];
          const swapIndex = direction === 'up' ? index - 1 : index + 1;
          [newItems[index], newItems[swapIndex]] = [newItems[swapIndex], newItems[index]];
          setItems(newItems);
        };

        const checkOrder = () => {
          const isCorrect = JSON.stringify(items) === JSON.stringify(question.correctAnswer);
          onAnswer(isCorrect);
        };

        return (
          <div className="mt-4 space-y-3">
            {items.map((item, idx) => (
              <motion.div layout key={item} className="bg-white p-3 rounded-lg border border-stone-200 flex items-center justify-between shadow-sm">
                <span className="text-stone-800">{item}</span>
                {!isAnswered && (
                  <div className="flex flex-col gap-1 ml-4">
                    <button 
                      onClick={() => moveItem(idx, 'up')} 
                      disabled={idx === 0}
                      className="p-1 hover:bg-stone-100 rounded disabled:opacity-30"
                    >
                      <ArrowUp size={16} />
                    </button>
                    <button 
                      onClick={() => moveItem(idx, 'down')} 
                      disabled={idx === items.length - 1}
                      className="p-1 hover:bg-stone-100 rounded disabled:opacity-30"
                    >
                      <ArrowDown size={16} />
                    </button>
                  </div>
                )}
              </motion.div>
            ))}
            {!isAnswered && (
              <button 
                onClick={checkOrder}
                className="w-full mt-4 bg-amber-600 text-white py-3 rounded-xl font-bold hover:bg-amber-700 transition-colors"
              >
                დადასტურება
              </button>
            )}
          </div>
        );
      };

      // 3. Matching
      const Matching = ({ question, onAnswer, isAnswered }) => {
        const [pairs, setPairs] = useState([]);
        const [selectedLeft, setSelectedLeft] = useState(null);
        
        useEffect(() => {
          const lefts = question.options.map(p => p.left);
          setPairs(lefts.map(l => ({ left: l, right: null })));
        }, [question]);

        const rightOptions = question.options.map(p => p.right).sort();

        const handleLeftClick = (left) => {
          if (isAnswered) return;
          setSelectedLeft(left);
        };

        const handleRightClick = (right) => {
          if (isAnswered || !selectedLeft) return;
          setPairs(prev => prev.map(p => p.left === selectedLeft ? { ...p, right } : p));
          setSelectedLeft(null);
        };

        const checkMatch = () => {
          const correctMap = new Map(question.options.map(p => [p.left, p.right]));
          const isCorrect = pairs.every(p => correctMap.get(p.left) === p.right);
          onAnswer(isCorrect);
        };

        const allMatched = pairs.every(p => p.right !== null);

        return (
          <div className="mt-6 space-y-6">
            <div className="flex gap-4">
              <div className="flex-1 space-y-3">
                {pairs.map((p) => (
                  <div 
                    key={p.left}
                    onClick={() => handleLeftClick(p.left)}
                    className={`p-3 rounded-lg border-2 cursor-pointer transition-colors min-h-[60px] flex items-center justify-center text-center
                      ${selectedLeft === p.left ? 'border-amber-500 bg-amber-50' : 'border-stone-200 bg-white'}
                      ${isAnswered ? (p.right === question.options.find(op => op.left === p.left)?.right ? 'border-emerald-500' : 'border-red-500') : ''}
                    `}
                  >
                    {p.left}
                  </div>
                ))}
              </div>
              <div className="flex-1 space-y-3">
                {rightOptions.map((r) => {
                   const isUsed = pairs.some(p => p.right === r);
                   return (
                    <div 
                      key={r}
                      onClick={() => handleRightClick(r)}
                      className={`p-3 rounded-lg border-2 cursor-pointer transition-colors min-h-[60px] flex items-center justify-center text-center
                        ${isUsed && !isAnswered ? 'bg-stone-100 text-stone-400 border-stone-100' : 'bg-white border-stone-200 hover:border-amber-300'}
                        ${isAnswered ? 'opacity-80' : ''}
                      `}
                    >
                      {r}
                    </div>
                   )
                })}
              </div>
            </div>

            <div className="text-sm text-stone-500 text-center">
              {pairs.filter(p => p.right).map((p, i) => (
                 <span key={i} className="inline-block bg-stone-100 px-2 py-1 rounded m-1">
                   {p.left} ↔ {p.right}
                 </span>
              ))}
            </div>

            {!isAnswered && allMatched && (
              <button onClick={checkMatch} className="w-full bg-amber-600 text-white py-3 rounded-xl font-bold">
                შემოწმება
              </button>
            )}
          </div>
        );
      }

      // 4. Dropdown
      const Dropdown = ({ question, onAnswer, isAnswered }) => {
        const segments = question.options;
        const [selections, setSelections] = useState({});

        const handleChange = (index, val) => {
          setSelections(prev => ({...prev, [index]: val}));
        };

        const check = () => {
          let correct = true;
          segments.forEach((seg, idx) => {
            if (seg.isBlank && selections[idx] !== seg.correctOption) {
              correct = false;
            }
          });
          onAnswer(correct);
        };

        return (
          <div className="mt-6 leading-loose text-lg text-stone-800">
            <div className="flex flex-wrap items-baseline gap-2">
              {segments.map((seg, idx) => {
                if (!seg.isBlank) return <span key={idx}>{seg.text}</span>;
                
                const isCorrect = isAnswered && selections[idx] === seg.correctOption;
                const isWrong = isAnswered && selections[idx] !== seg.correctOption;

                return (
                  <select
                    key={idx}
                    onChange={(e) => handleChange(idx, e.target.value)}
                    disabled={isAnswered}
                    className={`border-b-2 py-1 px-2 mx-1 outline-none bg-transparent font-bold
                      ${isCorrect ? 'border-emerald-500 text-emerald-700' : ''}
                      ${isWrong ? 'border-red-500 text-red-700' : ''}
                      ${!isAnswered ? 'border-stone-400 focus:border-amber-500' : ''}
                    `}
                    value={selections[idx] || ""}
                  >
                    <option value="" disabled>...</option>
                    {seg.options?.map(opt => (
                      <option key={opt} value={opt}>{opt}</option>
                    ))}
                  </select>
                );
              })}
            </div>
            {!isAnswered && (
              <button 
                onClick={check} 
                className="w-full mt-8 bg-amber-600 text-white py-3 rounded-xl font-bold"
              >
                დასრულება
              </button>
            )}
          </div>
        );
      };

      // 5. Grouping
      const Grouping = ({ question, onAnswer, isAnswered }) => {
        const items = question.options;
        const categories = Array.from(new Set(items.map(i => i.category)));
        const [itemCats, setItemCats] = useState({});

        const cycleCategory = (itemId) => {
          if (isAnswered) return;
          const currentCat = itemCats[itemId];
          const currentIndex = currentCat ? categories.indexOf(currentCat) : -1;
          const nextIndex = (currentIndex + 1) % categories.length;
          setItemCats(prev => ({...prev, [itemId]: categories[nextIndex]}));
        };

        const check = () => {
          const correct = items.every(i => itemCats[i.id] === i.category);
          onAnswer(correct);
        };
        
        const allCategorized = items.every(i => itemCats[i.id]);

        return (
          <div className="mt-6">
            <div className="flex gap-4 mb-4 flex-wrap justify-center">
              {categories.map((cat, idx) => (
                 <div key={cat} className={`px-3 py-1 rounded-full text-sm font-bold border 
                   ${idx === 0 ? 'bg-blue-100 text-blue-800 border-blue-200' : ''}
                   ${idx === 1 ? 'bg-orange-100 text-orange-800 border-orange-200' : ''}
                   ${idx === 2 ? 'bg-purple-100 text-purple-800 border-purple-200' : ''}
                   ${idx === 3 ? 'bg-pink-100 text-pink-800 border-pink-200' : ''}
                 `}>
                   {cat}
                 </div>
              ))}
            </div>
            <p className="text-sm text-center text-stone-500 mb-4">დააწექით ბარათს კატეგორიის შესაცვლელად</p>
            
            <div className="grid grid-cols-2 gap-3">
              {items.map((item) => {
                const cat = itemCats[item.id];
                const catIdx = cat ? categories.indexOf(cat) : -1;
                const isCorrect = isAnswered && cat === item.category;
                const isWrong = isAnswered && cat !== item.category;
                
                let colorClass = "bg-white border-stone-200";
                if (catIdx === 0) colorClass = "bg-blue-50 border-blue-300";
                if (catIdx === 1) colorClass = "bg-orange-50 border-orange-300";
                if (catIdx === 2) colorClass = "bg-purple-50 border-purple-300";
                if (catIdx === 3) colorClass = "bg-pink-50 border-pink-300";

                if (isAnswered) {
                   if (isCorrect) colorClass = "bg-emerald-100 border-emerald-500 ring-2 ring-emerald-500";
                   else colorClass = "bg-red-100 border-red-500 opacity-50";
                }

                return (
                  <button
                    key={item.id}
                    onClick={() => cycleCategory(item.id)}
                    disabled={isAnswered}
                    className={`p-4 rounded-xl border-2 transition-all duration-200 font-medium ${colorClass}`}
                  >
                    <div className="text-sm text-stone-400 mb-1">{cat || "?"}</div>
                    {item.text}
                  </button>
                )
              })}
            </div>

             {!isAnswered && allCategorized && (
              <button onClick={check} className="w-full mt-6 bg-amber-600 text-white py-3 rounded-xl font-bold">
                შემოწმება
              </button>
            )}
          </div>
        );
      }

      // --- MAIN APP COMPONENT ---
      const App = () => {
        const [state, setState] = useState(AppState.Menu);
        const [selectedFableId, setSelectedFableId] = useState(null);
        const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
        const [answers, setAnswers] = useState([]);
        const [isQuestionAnswered, setIsQuestionAnswered] = useState(false);
        const [lastCorrect, setLastCorrect] = useState(null);
        const [showTextModal, setShowTextModal] = useState(false);

        const currentFable = fables.find(f => f.id === selectedFableId);
        const fableQuestions = useMemo(() => 
          questions.filter(q => q.fableId === selectedFableId), 
        [selectedFableId]);

        const currentQuestion = fableQuestions[currentQuestionIndex];

        const startFable = (id) => {
          setSelectedFableId(id);
          setState(AppState.Quiz);
          setCurrentQuestionIndex(0);
          setAnswers([]);
          setIsQuestionAnswered(false);
          setLastCorrect(null);
          setShowTextModal(false);
        };

        const handleAnswer = (isCorrect) => {
          setIsQuestionAnswered(true);
          setLastCorrect(isCorrect);
          setAnswers(prev => [...prev, { questionId: currentQuestion.id, isCorrect }]);
        };

        const nextQuestion = () => {
          if (currentQuestionIndex < fableQuestions.length - 1) {
            setCurrentQuestionIndex(prev => prev + 1);
            setIsQuestionAnswered(false);
            setLastCorrect(null);
            setShowTextModal(false);
          } else {
            setState(AppState.Results);
          }
        };

        const returnToMenu = () => {
          setState(AppState.Menu);
          setSelectedFableId(null);
        };

        const renderMenu = () => (
          <div className="max-w-4xl mx-auto p-6">
            <header className="text-center mb-12 mt-8">
              <h1 className="text-4xl md:text-5xl font-bold text-stone-800 mb-4 tracking-tight">იგავ-არაკების სამყარო</h1>
              <p className="text-xl text-stone-600">აირჩიე იგავი და შეამოწმე შენი ცოდნა</p>
            </header>
            
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {fables.map(fable => (
                <motion.button
                  key={fable.id}
                  whileHover={{ scale: 1.02 }}
                  whileTap={{ scale: 0.98 }}
                  onClick={() => startFable(fable.id)}
                  className="bg-white rounded-2xl p-6 shadow-lg border border-stone-200 hover:border-amber-400 hover:shadow-xl transition-all text-left flex flex-col h-full"
                >
                  <div className="bg-amber-100 w-12 h-12 rounded-full flex items-center justify-center mb-4 text-amber-700">
                    <BookOpen size={24} />
                  </div>
                  <h3 className="text-xl font-bold text-stone-800 mb-2">{fable.title}</h3>
                  <p className="text-stone-500 text-sm flex-grow line-clamp-3">{fable.shortDesc}</p>
                  <div className="mt-4 text-amber-600 font-semibold text-sm flex items-center">
                    დაწყება →
                  </div>
                </motion.button>
              ))}
            </div>
          </div>
        );

        const renderQuiz = () => {
          if (!currentQuestion) return <div>Error</div>;

          const ComponentMap = {
            [QuestionType.MultipleChoice]: MultipleChoice,
            [QuestionType.Ordering]: Ordering,
            [QuestionType.TrueFalse]: MultipleChoice,
            [QuestionType.Matching]: Matching,
            [QuestionType.Dropdown]: Dropdown,
            [QuestionType.Grouping]: Grouping
          };

          const SpecificComponent = ComponentMap[currentQuestion.type];
          const progress = ((currentQuestionIndex) / fableQuestions.length) * 100;

          return (
            <div className="max-w-3xl mx-auto p-4 min-h-screen flex flex-col relative">
              <div className="flex items-center justify-between mb-6 z-10">
                <button onClick={returnToMenu} className="text-stone-500 hover:text-stone-800 flex items-center gap-2 text-sm font-bold">
                   <ChevronLeft size={16}/> მთავარი
                </button>
                <div className="text-stone-400 font-mono text-sm bg-stone-100 px-3 py-1 rounded-full">
                  {currentQuestionIndex + 1} / {fableQuestions.length}
                </div>
              </div>

              <div className="w-full bg-stone-200 h-2 rounded-full mb-8">
                <div 
                  className="bg-amber-500 h-2 rounded-full transition-all duration-500" 
                  style={{ width: `${progress}%` }}
                />
              </div>

              <AnimatePresence>
                {showTextModal && (
                  <motion.div 
                    initial={{ opacity: 0, y: 50 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0, y: 50 }}
                    className="fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4 bg-black/50 backdrop-blur-sm"
                  >
                    <div className="bg-white w-full max-w-2xl max-h-[80vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col relative">
                      <div className="p-4 border-b border-stone-100 flex justify-between items-center bg-stone-50">
                        <h3 className="font-bold text-stone-700">{currentFable?.title}</h3>
                        <button onClick={() => setShowTextModal(false)} className="p-2 hover:bg-stone-200 rounded-full">
                          <X size={20} />
                        </button>
                      </div>
                      <div className="p-6 overflow-y-auto leading-loose text-lg text-stone-800 text-justify">
                         {currentFable?.content.split('\n').map((para, i) => (
                           <p key={i} className="mb-4 last:mb-0">{para}</p>
                         ))}
                      </div>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>

              <AnimatePresence mode='wait'>
                <motion.div
                  key={currentQuestion.id}
                  initial={{ opacity: 0, x: 20 }}
                  animate={{ opacity: 1, x: 0 }}
                  exit={{ opacity: 0, x: -20 }}
                  className="bg-white rounded-3xl p-6 md:p-8 shadow-xl border border-stone-100 flex-grow relative"
                >
                  <div className="absolute top-6 right-6">
                    <button 
                      onClick={() => setShowTextModal(true)}
                      className="flex items-center gap-2 text-amber-600 bg-amber-50 hover:bg-amber-100 px-3 py-1.5 rounded-lg text-sm font-bold transition-colors"
                    >
                      <Eye size={16} /> ტექსტის ნახვა
                    </button>
                  </div>

                  <div className="flex gap-2 mb-4 mt-2">
                    <span className={`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider text-white
                      ${currentQuestion.level === CognitiveLevel.Comprehension ? 'bg-blue-400' : 
                        currentQuestion.level === CognitiveLevel.Analysis ? 'bg-purple-400' :
                        currentQuestion.level === CognitiveLevel.Evaluation ? 'bg-orange-400' : 'bg-green-400'
                      }
                    `}>
                      დონე {currentQuestion.level}
                    </span>
                  </div>

                  <h3 className="text-xl md:text-2xl font-bold text-stone-800 mb-6 serif-font pr-20 leading-relaxed">
                    {currentQuestion.prompt}
                  </h3>

                  <SpecificComponent 
                    question={currentQuestion} 
                    onAnswer={handleAnswer} 
                    isAnswered={isQuestionAnswered} 
                  />

                  {isQuestionAnswered && (
                    <motion.div 
                      initial={{ opacity: 0, y: 10 }}
                      animate={{ opacity: 1, y: 0 }}
                      className={`mt-8 p-6 rounded-2xl border-l-4 ${lastCorrect ? 'bg-emerald-50 border-emerald-500' : 'bg-red-50 border-red-500'}`}
                    >
                      <div className="flex items-center gap-3 mb-2">
                        {lastCorrect ? <CheckCircle className="text-emerald-600" /> : <Award className="text-red-600" />}
                        <span className={`font-bold text-lg ${lastCorrect ? 'text-emerald-800' : 'text-red-800'}`}>
                          {lastCorrect ? 'სწორია!' : 'არასწორია'}
                        </span>
                      </div>
                      <p className="text-stone-700 leading-relaxed">{currentQuestion.explanation}</p>
                      <button 
                        onClick={nextQuestion}
                        className="mt-4 bg-stone-900 text-white px-6 py-2 rounded-lg font-bold hover:bg-stone-700 transition-colors w-full md:w-auto"
                      >
                        {currentQuestionIndex < fableQuestions.length - 1 ? 'შემდეგი' : 'შედეგების ნახვა'}
                      </button>
                    </motion.div>
                  )}
                </motion.div>
              </AnimatePresence>
            </div>
          );
        };

        const renderResults = () => {
          const total = answers.length;
          const correct = answers.filter(a => a.isCorrect).length;
          const percentage = Math.round((correct / total) * 100);
          
          const stats = [
              { name: 'გააზრება', level: CognitiveLevel.Comprehension, total: 0, correct: 0 },
              { name: 'ანალიზი', level: CognitiveLevel.Analysis, total: 0, correct: 0 },
              { name: 'შეფასება', level: CognitiveLevel.Evaluation, total: 0, correct: 0 },
              { name: 'აქტუალობა', level: CognitiveLevel.Relevance, total: 0, correct: 0 },
          ];

          answers.forEach(ans => {
              const q = questions.find(q => q.id === ans.questionId);
              if (q) {
                  const stat = stats.find(s => s.level === q.level);
                  if (stat) {
                      stat.total++;
                      if (ans.isCorrect) stat.correct++;
                  }
              }
          });

          const chartData = stats.filter(s => s.total > 0).map(s => ({
              name: s.name,
              პროცენტი: Math.round((s.correct / s.total) * 100)
          }));

          return (
            <div className="max-w-3xl mx-auto p-6 flex flex-col items-center justify-center min-h-screen">
              <div className="bg-white rounded-3xl p-8 shadow-2xl w-full text-center border border-stone-200">
                  <div className="mb-6 inline-block p-4 rounded-full bg-amber-100 text-amber-600">
                      <Award size={48} />
                  </div>
                  <h2 className="text-4xl font-bold text-stone-800 mb-2">შედეგები</h2>
                  <p className="text-stone-500 mb-8">{currentFable?.title}</p>

                  <div className="text-6xl font-black text-stone-900 mb-2">
                      {percentage}%
                  </div>
                  <p className="text-lg text-stone-600 mb-10">
                      შენ უპასუხე {correct}-ს {total}-დან სწორად
                  </p>

                  <div className="h-64 w-full mb-10">
                      <ResponsiveContainer width="100%" height="100%">
                          <BarChart data={chartData}>
                              <XAxis dataKey="name" stroke="#78716c" fontSize={12} tickLine={false} axisLine={false} />
                              <YAxis hide domain={[0, 100]} />
                              <Tooltip 
                                  cursor={{fill: '#f5f5f4'}}
                                  contentStyle={{borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'}}
                              />
                              <Bar dataKey="პროცენტი" radius={[4, 4, 0, 0]}>
                                  {chartData.map((entry, index) => (
                                      <Cell key={`cell-${index}`} fill={entry.პროცენტი > 70 ? '#10b981' : entry.პროცენტი > 40 ? '#f59e0b' : '#ef4444'} />
                                  ))}
                              </Bar>
                          </BarChart>
                      </ResponsiveContainer>
                      <p className="text-xs text-stone-400 mt-2">წარმატება კატეგორიების მიხედვით</p>
                  </div>

                  <div className="flex gap-4 justify-center">
                      <button 
                          onClick={() => startFable(selectedFableId)}
                          className="flex items-center gap-2 px-6 py-3 bg-white border-2 border-stone-200 text-stone-700 rounded-xl font-bold hover:bg-stone-50 transition-colors"
                      >
                          <RefreshCw size={18} /> თავიდან
                      </button>
                      <button 
                          onClick={returnToMenu}
                          className="flex items-center gap-2 px-6 py-3 bg-stone-900 text-white rounded-xl font-bold hover:bg-stone-700 transition-colors"
                      >
                          <BookOpen size={18} /> მთავარი მენიუ
                      </button>
                  </div>
              </div>
            </div>
          );
        };

        return (
          <div className="min-h-screen bg-stone-100 font-sans">
            {state === AppState.Menu && renderMenu()}
            {state === AppState.Quiz && renderQuiz()}
            {state === AppState.Results && renderResults()}
          </div>
        );
      }

      const root = createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>